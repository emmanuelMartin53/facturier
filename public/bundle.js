(()=>{"use strict";class t{documentType;firstName;lastName;address;country;town;zip;product;price;quantity;tva;date;constructor(t,e,n,i,s,o,a,r,l,d,c,h){this.documentType=t,this.firstName=e,this.lastName=n,this.address=i,this.country=s,this.town=o,this.zip=a,this.product=r,this.price=l,this.quantity=d,this.tva=c,this.date=h}subTotal(t,e,n){return(t+t*(n/100))*e}htmlFormat(){const t=this.subTotal(this.price,this.quantity,this.tva);return`<div class="row p-5">\n    <div class="col-md-6">\n        <h2 class="text-left">LOGO</h2>\n    </div>\n    <div class="col-md-6 text-right">\n        <p class="font-weight-bold mb-1">${"invoice"===this.documentType?"Facture":"Devis"}<span class="font-weight-normal">N° ${Math.floor(101*Math.random())}</span></p>\n        <p class="font-weight-bold mb-1">Date <span class="font-weight-normal">${this.date.toLocaleDateString()}</span></p>\n    </div>\n</div>\n\n<div class="row pb-5 p-5">\n    <div class="col-sm-6 text-left">\n        <p class="font-weight-bold">Entreprise de Toto</p>\n        <p class="mb-1">22 boulevard Moe Szyslak</p>\n        <p>75008 - Paris</p>\n        <p class="mb-1">Tél: 00.00.00.00.00</p>\n    </div>\n\n    <div class="col-sm-6 text-right">\n        <p class="font-weight-bold">Informations du client</p>\n        <p class="mb-1">Mr/Mme ${this.firstName} ${this.lastName}</p>\n        <p class="mb-1">${this.address}</p>\n        <p>${this.country}</p>\n        <p>${this.town}</p>\n        <p>${this.zip}</p>\n    </div>\n</div>\n\n<div class="row p-5">\n    <div class="col-md-12">\n        <table class="table">\n        <thead>\n            <tr>\n            <th class="border-0 text-uppercase small font-weight-bold">Produit/Service</th>\n            <th class="border-0 text-uppercase small font-weight-bold">Prix unitaire HT</th>\n            <th class="border-0 text-uppercase small font-weight-bold">Quantité</th>\n            <th class="border-0 text-uppercase small font-weight-bold">Total HT</th>\n            </tr>\n        </thead>\n        <tbody>\n            <tr>\n            <td>${this.product}</td>\n            <td>${this.price} € HT</td>\n            <td>${this.quantity}</td>\n            <td>${this.price*this.quantity} € HT</td>\n            </tr>\n        </tbody>\n        </table>\n    </div>\n</div>\n\n<div class="d-flex flex-row-reverse bg-light p-4">\n    <div class="py-3 px-5">\n        <div class="mb-2">TOTAL TTC</div>\n        <div class="h2 font-weight-light">${t.toFixed(2)} €</div>\n    </div>\n</div>`}}class e{oldData=[];constructor(t,e){this.setItem(t,e)}static checkLocaleStorage(){null===localStorage.getItem("invoice")&&localStorage.setItem("invoice","[]"),null===localStorage.getItem("estimate")&&localStorage.setItem("estimate","[]")}setItem(t,e){let n;n=localStorage.getItem(t),null!==n?(this.oldData=JSON.parse(n),this.oldData.push(e),localStorage.setItem(t,JSON.stringify(this.oldData))):document.location.reload()}}class n{container;hiddenDiv;printButton;formContainer;constructor(t,e,n){this.container=t,this.hiddenDiv=e,this.printButton=n,this.formContainer=document.getElementById("form-container")}render(t,n){const i=t.htmlFormat();this.container.innerHTML=i,new e(n,i),this.printButton.innerHTML="invoice"===n?"Imprimer la facture":"imprimer le devis",this.hiddenDiv.classList.remove("invisible"),this.formContainer.innerHTML=""}}class i{element;constructor(t){this.element=t}print(){document.body.innerHTML=this.element.innerHTML,window.print(),document.location.reload()}}class s{form;type;firstName;lastName;address;country;town;zip;product;price;quantity;tva;docContainer;storedData;hiddenDiv;printButton;reloadButton;invoiceButton;estimateButton;constructor(){this.form=document.querySelector("#form"),this.type=document.querySelector("#type"),this.firstName=document.getElementById("firstName"),this.lastName=document.getElementById("lastName"),this.address=document.getElementById("address"),this.country=document.getElementById("country"),this.town=document.getElementById("town"),this.zip=document.getElementById("zip"),this.product=document.getElementById("product"),this.price=document.getElementById("price"),this.quantity=document.getElementById("quantity"),this.tva=document.getElementById("tva"),this.storedData=document.getElementById("stored-data"),this.docContainer=document.getElementById("document-container"),this.hiddenDiv=document.getElementById("hiddenDiv"),this.printButton=document.getElementById("print"),this.reloadButton=document.getElementById("reload"),this.invoiceButton=document.getElementById("stored-invoices"),this.estimateButton=document.getElementById("stored-estimates"),this.submitFormListener(),this.printListener(this.printButton,this.docContainer),this.reloadListener(this.reloadButton),this.getStoreDocsListener()}submitFormListener(){this.form.addEventListener("submit",this.handleFormSubmit)}printListener(t,e){t.addEventListener("click",()=>{let t;t=new i(e),t.print()})}reloadListener(t){t.addEventListener("click",()=>{document.location.reload(),window.scrollTo(0,0)})}getStoreDocsListener(){this.invoiceButton.addEventListener("click",()=>this.getItems("invoice")),this.estimateButton.addEventListener("click",()=>this.getItems("estimate"))}getItems(t){if(console.log(this),this.storedData.hasChildNodes()&&(this.storedData.innerHTML=""),localStorage.getItem(t)){let e;if(e=localStorage.getItem(t),null!==e&&e.length>2){let t;t=JSON.parse(e),t.map(t=>{let e=document.createElement("div"),n=document.createElement("div");e.classList.add("card","mt-5"),n.classList.add("card-body"),n.innerHTML=t,e.append(n),this.storedData.append(e)})}else this.storedData.innerHTML='<div class="p-5"> Aucune Data disponible </div>'}}handleFormSubmit(e){e.preventDefault(),console.log(this);const i=this.inputDatas();if(Array.isArray(i)){const[e,s,o,a,r,l,d,c,h,m,u]=i;let p;console.log(e,s,o,a,r,l,d,c,h,m,u);let v,g=new Date;p=new t(e,s,o,a,r,l,d,c,h,m,u,g),v=new n(this.docContainer,this.hiddenDiv,this.printButton),v.render(p,e)}}inputDatas(){const t=this.type.value,e=this.firstName.value,n=this.lastName.value,i=this.address.value,s=this.country.value,o=this.town.value,a=this.zip.valueAsNumber,r=this.product.value,l=this.price.valueAsNumber,d=this.quantity.valueAsNumber,c=this.tva.valueAsNumber;if(a>0&&l>0&&d>0&&c>0)return[t,e,n,i,s,o,a,r,l,d,c];alert("les valeurs numériques doivent etre > 0 !")}}(function(t,e,n,i){var s,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(o<3?s(a):o>3?s(e,n,a):s(e,n))||a);o>3&&a&&Object.defineProperty(e,n,a)})([function(t,e,n){const i=n.value;return{get(){return i.bind(this)}}}],s.prototype,"handleFormSubmit",null),new s,e.checkLocaleStorage(),console.log("Donkey Geek est cool")})();